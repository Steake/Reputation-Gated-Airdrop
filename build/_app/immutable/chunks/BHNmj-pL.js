(function(){try{var o=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};o.SENTRY_RELEASE={id:"b1e593ae5130a8a866939fcd32d632e0f276c846"}}catch{}})();try{(function(){var o=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},e=new o.Error().stack;e&&(o._sentryDebugIds=o._sentryDebugIds||{},o._sentryDebugIds[e]="6a4f2378-fe70-4b41-a699-9d6b25d9a1d9",o._sentryDebugIdIdentifier="sentry-dbid-6a4f2378-fe70-4b41-a699-9d6b25d9a1d9")})()}catch{}class f{constructor(){this.config={enabled:!0,logToConsole:!0},this.events=[],this.maxEvents=100}configure(e){this.config={...this.config,...e}}trackProof(e){var s,r,n,i;if(!this.config.enabled)return;const t={method:e.method,ms:e.ms,size:e.size,device:{type:((s=e.device)==null?void 0:s.type)||this.detectDeviceType(),ramCategory:((r=e.device)==null?void 0:r.ramCategory)||this.detectRAMCategory(),browser:((n=e.device)==null?void 0:n.browser)||this.detectBrowser(),wasmSupported:((i=e.device)==null?void 0:i.wasmSupported)??this.detectWASMSupport()},timestamp:Date.now(),success:e.success??!0,errorType:e.errorType};if(this.events.push(t),this.events.length>this.maxEvents&&this.events.shift(),this.config.logToConsole&&console.log("[Telemetry] Proof event:",{method:t.method,duration:`${t.ms}ms`,size:t.size,device:t.device,success:t.success,...t.errorType&&{error:t.errorType}}),this.config.sink)try{this.config.sink(t)}catch(c){console.error("[Telemetry] Sink error:",c)}}getEvents(){return[...this.events]}clearEvents(){this.events=[]}getStats(){if(this.events.length===0)return{totalProofs:0,successRate:0,avgDuration:0,methodBreakdown:{},deviceBreakdown:{}};const e=this.events.filter(n=>n.success).length,t=this.events.reduce((n,i)=>n+i.ms,0),s={},r={};for(const n of this.events)s[n.method]=(s[n.method]||0)+1,r[n.device.type]=(r[n.device.type]||0)+1;return{totalProofs:this.events.length,successRate:e/this.events.length,avgDuration:t/this.events.length,methodBreakdown:s,deviceBreakdown:r}}detectDeviceType(){if(typeof navigator>"u")return"unknown";const e=navigator.userAgent.toLowerCase();return/mobile|android|iphone|ipod/.test(e)?"mobile":/tablet|ipad/.test(e)?"tablet":"desktop"}detectRAMCategory(){if(typeof navigator>"u")return"unknown";const e=navigator.deviceMemory;return typeof e!="number"?"unknown":e<4?"low":e<=8?"medium":"high"}detectBrowser(){if(typeof navigator>"u")return"other";const e=navigator.userAgent.toLowerCase();return e.includes("edg")?"edge":e.includes("chrome")?"chrome":e.includes("firefox")?"firefox":e.includes("safari")?"safari":"other"}detectWASMSupport(){try{if(typeof WebAssembly=="object"&&typeof WebAssembly.instantiate=="function"){const e=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(e instanceof WebAssembly.Module)return new WebAssembly.Instance(e)instanceof WebAssembly.Instance}}catch{return!1}return!1}}const d=new f,a=d.trackProof.bind(d);export{a,d as t};
