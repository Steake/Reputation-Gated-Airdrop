import{bm as p,bn as h,bo as w,bp as m,bq as E,br as k,bs as L,bt as O,bu as R,bv as x,bw as b,bx as T}from"./C5PuhdNm.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};e.SENTRY_RELEASE={id:"b1e593ae5130a8a866939fcd32d632e0f276c846"}}catch{}})();try{(function(){var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="cb07c84b-5790-4f51-af50-8a25cc323826",e._sentryDebugIdIdentifier="sentry-dbid-cb07c84b-5790-4f51-af50-8a25cc323826")})()}catch{}class S extends p{constructor({callbackSelector:t,cause:s,data:c,extraData:d,sender:f,urls:r}){var o;super(s.shortMessage||"An error occurred while fetching for an offchain result.",{cause:s,metaMessages:[...s.metaMessages||[],(o=s.metaMessages)!=null&&o.length?"":[],"Offchain Gateway Call:",r&&["  Gateway URL(s):",...r.map(i=>`    ${h(i)}`)],`  Sender: ${f}`,`  Data: ${c}`,`  Callback selector: ${t}`,`  Extra data: ${d}`].flat(),name:"OffchainLookupError"})}}class M extends p{constructor({result:t,url:s}){super("Offchain gateway response is malformed. Response data must be a hex value.",{metaMessages:[`Gateway URL: ${h(s)}`,`Response: ${w(t)}`],name:"OffchainLookupResponseMalformedError"})}}class q extends p{constructor({sender:t,to:s}){super("Reverted sender address does not match target contract address (`to`).",{metaMessages:[`Contract address: ${s}`,`OffchainLookup sender address: ${t}`],name:"OffchainLookupSenderMismatchError"})}}const A="0x556f1830",D={name:"OffchainLookup",type:"error",inputs:[{name:"sender",type:"address"},{name:"urls",type:"string[]"},{name:"callData",type:"bytes"},{name:"callbackFunction",type:"bytes4"},{name:"extraData",type:"bytes"}]};async function C(e,{blockNumber:t,blockTag:s,data:c,to:d}){const{args:f}=m({data:c,abi:[D]}),[r,o,i,l,n]=f,{ccipRead:a}=e,y=a&&typeof(a==null?void 0:a.request)=="function"?a.request:$;try{if(!E(d,r))throw new q({sender:r,to:d});const u=o.includes(k)?await L({data:i,ccipRequest:y}):await y({data:i,sender:r,urls:o}),{data:g}=await O(e,{blockNumber:t,blockTag:s,data:R([l,x([{type:"bytes"},{type:"bytes"}],[u,n])]),to:d});return g}catch(u){throw new S({callbackSelector:l,cause:u,data:c,extraData:n,sender:r,urls:o})}}async function $({data:e,sender:t,urls:s}){var d;let c=new Error("An unknown error occurred.");for(let f=0;f<s.length;f++){const r=s[f],o=r.includes("{data}")?"GET":"POST",i=o==="POST"?{data:e,sender:t}:void 0,l=o==="POST"?{"Content-Type":"application/json"}:{};try{const n=await fetch(r.replace("{sender}",t.toLowerCase()).replace("{data}",e),{body:JSON.stringify(i),headers:l,method:o});let a;if((d=n.headers.get("Content-Type"))!=null&&d.startsWith("application/json")?a=(await n.json()).data:a=await n.text(),!n.ok){c=new b({body:i,details:a!=null&&a.error?w(a.error):n.statusText,headers:n.headers,status:n.status,url:r});continue}if(!T(a)){c=new M({result:a,url:r});continue}return a}catch(n){c=new b({body:i,details:n.message,url:r})}}throw c}export{$ as ccipRequest,C as offchainLookup,D as offchainLookupAbiItem,A as offchainLookupSignature};
