import{d as l,w as u}from"./D7JtYkVa.js";import{w as d,a as g}from"./DVzSPLFO.js";import{p as h}from"./B2ztehUk.js";import{F as i}from"./CkpMGzDD.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};e.SENTRY_RELEASE={id:"b1e593ae5130a8a866939fcd32d632e0f276c846"}}catch{}})();try{(function(){var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},o=new e.Error().stack;o&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[o]="eca121e1-af8e-4e49-a2e0-44735a48706b",e._sentryDebugIdIdentifier="sentry-dbid-eca121e1-af8e-4e49-a2e0-44735a48706b")})()}catch{}const r=u({loading:!1}),a="reputation_score_cache",p=5*60*1e3,f=h(),w="error"in f?!0:!f.API_BASE;function S(e){if(typeof window>"u"||!e)return null;const o=localStorage.getItem(`${a}_${e}`);if(!o)return null;const t=JSON.parse(o);return Date.now()-t.cachedAt>p?(localStorage.removeItem(`${a}_${e}`),null):t}function s(e,o){typeof window>"u"||e&&localStorage.setItem(`${a}_${e}`,JSON.stringify({...o,cachedAt:Date.now()}))}typeof window<"u"&&d.subscribe(e=>{e.address&&Object.keys(localStorage).forEach(o=>{o.startsWith(`${a}_`)&&localStorage.removeItem(o)})});const b={high:95e4,medium:75e4,threshold:62e4,ineligible:45e4},m=l([g,d],([e,o])=>{const t=e.enabled?"mock":o.address;if(t){const n=S(t);if(n&&!n.error)return n}if(e.enabled&&e.connectionState==="connected"){const n={loading:!1,value:b[e.userReputationTier],lastUpdated:new Date().toISOString(),error:void 0,cachedAt:Date.now()};return t&&s(t,n),n}if(!w)return{loading:!!t,value:void 0,lastUpdated:void 0,error:void 0,cachedAt:void 0};if(o.connected&&!e.enabled&&t&&typeof t=="string"&&t.startsWith("0x")){const n={loading:!1,value:v(t),lastUpdated:new Date().toISOString(),error:void 0,cachedAt:Date.now()};return s(t,n),n}return{loading:!1,value:void 0,lastUpdated:void 0,error:void 0,cachedAt:void 0}});m.subscribe(e=>{r.set(e)});function v(e){const o=e.toLowerCase();let t=0;for(let c=2;c<Math.min(o.length,10);c++)t+=o.charCodeAt(c);const n=t%1e3/1e3;return Math.floor(4e5+n*55e4)}const I={setLoading:e=>{r.update(o=>({...o,loading:e}))},setValue:e=>{const o={...i(r),value:e,lastUpdated:new Date().toISOString(),error:void 0,cachedAt:Date.now()};r.set(o);const t=i(d);t!=null&&t.address&&s(t.address,o)},setError:e=>{const t={...i(r),error:e,loading:!1,cachedAt:Date.now()};r.set(t);const n=i(d);n!=null&&n.address&&s(n.address,t)},reset:()=>{r.set({loading:!1})},clearCache:e=>{typeof window<"u"&&localStorage&&localStorage.removeItem(`${a}_${e}`)}};export{I as a,r as s};
